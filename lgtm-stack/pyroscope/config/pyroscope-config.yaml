###############################################################################
# Pyroscope Configuration - ECS Fargate 호환
###############################################################################

target: all                               # single-binary 모드

###############################################################################
# 멀티테넌시 설정
###############################################################################
multitenancy_enabled: true                # 멀티테넌트 활성화 (X-Scope-OrgID 헤더 필수)
auth_enabled: true                        # 인증 활성화

###############################################################################
# 서버 설정
###############################################################################
server:
  http_listen_port: 4040
  grpc_listen_port: 4041
  log_level: info

###############################################################################
# S3 스토리지 (환경변수 사용)
###############################################################################
storage:
  backend: s3
  s3:
    bucket_name: ${PYROSCOPE_S3_BUCKET}
    endpoint: s3.${AWS_REGION}.amazonaws.com
    region: ${AWS_REGION}
    insecure: false
  prefix: pyroscope

###############################################################################
# PyroscopeDB 설정
###############################################################################
pyroscopedb:
  data_path: /data
  max_block_duration: 1h                  # 헤드 블록 1시간마다 컷팅

###############################################################################
# Compactor 설정
###############################################################################
compactor:
  deletion_delay: 12h                     # soft-delete → hard-delete 지연값

###############################################################################
# Limits (보존 정책)
###############################################################################
limits:
  compactor_blocks_retention_period: 720h # 30일 보존
